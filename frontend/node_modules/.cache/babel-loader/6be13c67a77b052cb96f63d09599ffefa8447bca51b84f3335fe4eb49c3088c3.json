{"ast":null,"code":"import _slicedToArray from\"C:/Users/paulm/Documents/Local Programming/Websites/SnowFinder/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useState}from\"react\";import{Client}from\"@stomp/stompjs\";// let stompClient: CompatClient;\nvar stompClient;export default function useStomp(connectionUrl){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),message=_useState2[0],setMessage=_useState2[1];useEffect(function(){stompClient=new Client({brokerURL:connectionUrl,reconnectDelay:5000,heartbeatIncoming:4000,heartbeatOutgoing:4000});stompClient.onConnect=function(){console.log(\"Connected!!\");stompClient.subscribe('/results/snow',function(msg){if(!msg.body)return;setMessage(String(msg.body));});};stompClient.onStompError=function(frame){// Will be invoked in case of error encountered at Broker\n// Bad login/passcode typically will cause an error\n// Complaint brokers will set `message` header with a brief message. Body may contain details.\n// Compliant brokers will terminate the connection after any error\nconsole.log('Broker reported error: '+frame.headers['message']);console.log('Additional details: '+frame.body);};stompClient.activate();},[connectionUrl]);var send=function send(endpoint,body){stompClient.publish({destination:endpoint,body:body,skipContentLengthHeader:true});};return{message:message,send:send};}","map":{"version":3,"names":["useEffect","useState","Client","stompClient","useStomp","connectionUrl","_useState","_useState2","_slicedToArray","message","setMessage","brokerURL","reconnectDelay","heartbeatIncoming","heartbeatOutgoing","onConnect","console","log","subscribe","msg","body","String","onStompError","frame","headers","activate","send","endpoint","publish","destination","skipContentLengthHeader"],"sources":["C:/Users/paulm/Documents/Local Programming/Websites/SnowFinder/frontend/src/hooks/useStomp.ts"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport { Client } from \"@stomp/stompjs\";\r\n\r\n// let stompClient: CompatClient;\r\nlet stompClient: Client;\r\n\r\nexport default function useStomp(connectionUrl: string) {\r\n    const [message, setMessage] = useState('');\r\n\r\n    useEffect(() => {\r\n        stompClient = new Client({ \r\n            brokerURL: connectionUrl,\r\n            reconnectDelay: 5000,\r\n            heartbeatIncoming: 4000,\r\n            heartbeatOutgoing: 4000,\r\n        });\r\n        stompClient.onConnect = () => {\r\n            console.log(\"Connected!!\");\r\n            stompClient.subscribe('/results/snow', function (msg) {\r\n                if (!msg.body) return;\r\n                setMessage(String(msg.body));\r\n            });\r\n        };\r\n        stompClient.onStompError = function (frame) {\r\n            // Will be invoked in case of error encountered at Broker\r\n            // Bad login/passcode typically will cause an error\r\n            // Complaint brokers will set `message` header with a brief message. Body may contain details.\r\n            // Compliant brokers will terminate the connection after any error\r\n            console.log('Broker reported error: ' + frame.headers['message']);\r\n            console.log('Additional details: ' + frame.body);\r\n        };\r\n        stompClient.activate();\r\n    }, [connectionUrl]);\r\n\r\n    const send = (endpoint: string, body?: any) => {\r\n        stompClient.publish({ \r\n            destination: endpoint, \r\n            body,\r\n            skipContentLengthHeader: true\r\n        });\r\n    };\r\n\r\n    return {\r\n        message,\r\n        send\r\n    }\r\n}"],"mappings":"6JAAA,OAASA,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAC3C,OAASC,MAAM,KAAQ,gBAAgB,CAEvC;AACA,GAAI,CAAAC,WAAmB,CAEvB,cAAe,SAAS,CAAAC,QAAQA,CAACC,aAAqB,CAAE,CACpD,IAAAC,SAAA,CAA8BL,QAAQ,CAAC,EAAE,CAAC,CAAAM,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAAnCG,OAAO,CAAAF,UAAA,IAAEG,UAAU,CAAAH,UAAA,IAE1BP,SAAS,CAAC,UAAM,CACZG,WAAW,CAAG,GAAI,CAAAD,MAAM,CAAC,CACrBS,SAAS,CAAEN,aAAa,CACxBO,cAAc,CAAE,IAAI,CACpBC,iBAAiB,CAAE,IAAI,CACvBC,iBAAiB,CAAE,IACvB,CAAC,CAAC,CACFX,WAAW,CAACY,SAAS,CAAG,UAAM,CAC1BC,OAAO,CAACC,GAAG,CAAC,aAAa,CAAC,CAC1Bd,WAAW,CAACe,SAAS,CAAC,eAAe,CAAE,SAAUC,GAAG,CAAE,CAClD,GAAI,CAACA,GAAG,CAACC,IAAI,CAAE,OACfV,UAAU,CAACW,MAAM,CAACF,GAAG,CAACC,IAAI,CAAC,CAAC,CAChC,CAAC,CAAC,CACN,CAAC,CACDjB,WAAW,CAACmB,YAAY,CAAG,SAAUC,KAAK,CAAE,CACxC;AACA;AACA;AACA;AACAP,OAAO,CAACC,GAAG,CAAC,yBAAyB,CAAGM,KAAK,CAACC,OAAO,CAAC,SAAS,CAAC,CAAC,CACjER,OAAO,CAACC,GAAG,CAAC,sBAAsB,CAAGM,KAAK,CAACH,IAAI,CAAC,CACpD,CAAC,CACDjB,WAAW,CAACsB,QAAQ,EAAE,CAC1B,CAAC,CAAE,CAACpB,aAAa,CAAC,CAAC,CAEnB,GAAM,CAAAqB,IAAI,CAAG,QAAP,CAAAA,IAAIA,CAAIC,QAAgB,CAAEP,IAAU,CAAK,CAC3CjB,WAAW,CAACyB,OAAO,CAAC,CAChBC,WAAW,CAAEF,QAAQ,CACrBP,IAAI,CAAJA,IAAI,CACJU,uBAAuB,CAAE,IAC7B,CAAC,CAAC,CACN,CAAC,CAED,MAAO,CACHrB,OAAO,CAAPA,OAAO,CACPiB,IAAI,CAAJA,IACJ,CAAC,CACL"},"metadata":{},"sourceType":"module","externalDependencies":[]}